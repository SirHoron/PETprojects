<!DOCTYPE html>
{% load static %}
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Мир Коктейлей | Админ-панель</title>
    <link rel="stylesheet" href="{% static "css\admin.css" %}">
    <link rel="stylesheet" href="{% static "css\Base.css" %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Шапка с навигацией -->
    {% include "BaseHeader.html" with main="active" only %}

    <!-- Заголовок админ-панели -->
    <section class="admin-header">
        <div class="container">
            <h1 class="admin-title">
                <i class="fas fa-cogs"></i> Админ-панель
            </h1>
            <p class="admin-subtitle">Управление базой коктейлей и контентом сайта</p>
        </div>
    </section>

    <!-- Основной контейнер админ-панели -->
    <div class="container">
        <div class="admin-container">
            <!-- Панель управления -->
            <aside class="admin-sidebar">
                <div class="admin-stats">
                    <div class="stat-card">
                        <div class="stat-number" id="totalCocktails">0</div>
                        <div class="stat-label">Всего коктейлей</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="ibaCocktails">0</div>
                        <div class="stat-label">Коктейлей IBA</div>
                    </div>
                </div>
            </aside>

            <!-- Форма создания коктейля -->
            <main class="admin-form-container">
                <h2 class="form-title" id="formTitle">Создание нового коктейля</h2>
                
                <form class="cocktail-form" id="cocktailForm" method="post" action="">
                    {% csrf_token %}
                    <input type="hidden" id="cocktailId" value="">
                    
                    <div class="form-group">
                        <label class="form-label" for="cocktailName">
                            Название коктейля <span class="required">*</span>
                        </label>
                        <input type="text" id="cocktailName" class="form-input" name="name" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="cocktailtemp">
                            Температура подачи <span class="required">*</span>
                        </label>
                        <input type="number" id="cocktailtemp" class="form-input" name="tmre" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="cocktailtemp">
                            Время приготовления <span class="required">*</span>
                        </label>
                        <input type="number" id="cocktailtemp" class="form-input" name="ctime" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="cocktailStrength%">
                            Крепость в % <span class="required">*</span>
                        </label>
                        <input type="number" id="cocktailStrength%" class="form-input" name="strengthprocent" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="cocktailCategory">
                            Категория <span class="required">*</span>
                        </label>
                        <select id="cocktailCategory" class="form-select" name="category" required>
                            <option value="">Выберите категорию</option>
                            <option value="Unforgettable">Незабываемый</option>
                            <option value="refreshing">Освежающий</option>
                            <option value="sweet">Сладкий</option>
                            <option value="sour">Кислый</option>
                            <option value="coffee">Кофейный</option>
                            <option value="non-alcoholic">Безалкогольный</option>
                            <option value="modern">Современная классика</option>
                            <option value="new-epoch">Новой эры</option>
                            <option value="spicy">Пряный</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="cocktailType">
                            Тип коктейля
                        </label>
                        <select id="cocktailType" name="type" class="form-select">
                            <option value="classic">Классика</option>
                            <option value="iba">Официальный IBA</option>
                            <option value="modern">Современный</option>
                            <option value="signature">Авторский</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="cocktailStrength">
                            Крепость
                        </label>
                        <select id="cocktailStrength" name="strenght" class="form-select">
                            <option value="Низкая">Низкая</option>
                            <option value="Средняя" selected>Средняя</option>
                            <option value="Высокая">Высокая</option>
                            <option value="Безалкогольный">Безалкогольный</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="cocktailGlass">
                            Тип бокала
                        </label>
                        <input type="text" id="cocktailGlass" class="form-input" name="glass" value="Old Fashioned">
                        <div class="form-hint">Например: Old Fashioned, Хайбол, Мартини</div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label class="form-label" for="cocktailImage">
                            Ссылка на изображение <span class="required">*</span>
                        </label>
                        <input type="text" id="cocktailImage" class="form-input" name="image" required 
                               placeholder="Пина-колада, виски-сауэр, беломор и др.">
                        <div class="form-hint">Нужно указать название хранимого файла</div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label class="form-label">
                            Ингредиенты <span class="required">*</span>
                        </label>
                        <div class="ingredients-container" id="ingredientsContainer">
                            <div class="ingredient-row">
                                <input type="text" class="form-input ingredient-name" name="ingr1" placeholder="Название ингредиента">
                                <div style="display: flex; gap: 10px;">
                                    <input type="number" class="form-input ingredient-amount" placeholder="Количество" name="count1" style="flex: 1;">
                                    <button type="button" class="remove-ingredient-btn" id="remove-ingredient-btn">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="add-ingredient-btn" id="addIngredientBtn">
                            <i class="fas fa-plus"></i> Добавить ингредиент
                        </button>
                    </div>
                    
                    <div class="form-group full-width">
                        <label class="form-label" for="cocktailDescription">
                            Краткое описание <span class="required">*</span>
                        </label>
                        <textarea id="cocktailDescription" name="description" class="form-textarea small" required 
                                  placeholder="Краткое описание коктейля для карточки..."></textarea>
                        <div class="form-hint">Опишите вкус, историю или особенности коктейля (максимум 200 символов)</div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label class="form-label" for="cocktailHistory">
                            Подробная история и описание
                        </label>
                        <textarea id="cocktailHistory" name="history" class="form-textarea" 
                                  placeholder="Подробная история создания коктейля, особенности приготовления и подачи..."></textarea>
                        <div class="form-hint">Этот текст будет отображаться на странице коктейля</div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label class="form-label" for="cocktailInstructions">
                            Инструкция по приготовлению
                        </label>
                        <textarea id="cocktailInstructions" name="cooking" class="form-textarea" 
                                  placeholder="Пошаговая инструкция приготовления коктейля..."></textarea>
                        <div class="form-hint">Опишите шаги приготовления, каждый с новой строки</div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="admin-btn primary" id="submitFormBtn" onclick=buttonform()>
                            <i class="fas fa-save"></i> Сохранить коктейль
                        </button>
                    </div>
                </form>
            </main>
        </div>
    </div>

    <!-- Подвал -->
    {% include "BaseFooter.html" %}

    <script>
        class IngrContCountFunc {
            count = 1;
            ingredientsContainer(btn) {
                if (this.count > 1){
                        btn.remove();
                        this.count -= 1;
                    }
                }};

        const ICCF = new IngrContCountFunc();

        function NewListener(row){
            const ribs = document.querySelectorAll(".remove-ingredient-btn");
            ribs[ICCF.count-1].addEventListener("click", ()=>{ICCF.ingredientsContainer( row )});
        }

        NewListener();

        const aic = document.getElementById("addIngredientBtn");

        aic.addEventListener("click", ()=>{
            ICCF.count += 1;
            const ic = document.getElementById("ingredientsContainer");
            const row = document.createElement('div');
            row.className = 'ingredient-row';
            row.innerHTML = `
                                <input type="text" class="form-input ingredient-name" name="ingr${ICCF.count}" placeholder="Название ингредиента">
                                <div style="display: flex; gap: 10px;">
                                    <input type="number" class="form-input ingredient-amount" placeholder="Количество" name="count${ICCF.count}" style="flex: 1;">
                                    <button type="button" class="remove-ingredient-btn" id="remove-ingredient-btn">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>`
            ic.appendChild(row);
            NewListener(row);
        })

        function buttonform() {
            const form = document.querySelector("form");
            reqv = new FormData(form);
            
            return fetch("", {
                method: "POST",
                body: reqv,
            });
        }
        
    </script>
</body>
</html>